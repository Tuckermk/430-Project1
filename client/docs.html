

<!DOCTYPE html>
<html lang="en">
<head>
  <title>Countries API</title>
  <link rel="stylesheet" type="text/css" href="/style.css">
  
  <script>

   function handleResponse(response) {

      response.text().then((resText) => {

        const contentType = response.headers.get('Content-Type');

        //Grab the content section from the HTML so we can put things on the screen.
        const content = document.querySelector('#content');
        //Add a horizontal rule.
        content.appendChild(document.createElement('hr'));

        //Create some dom elements to display later
        const h1 = document.createElement('h5');
        const p = document.createElement('p');
        const h2 = document.createElement('h6');
        const rawData = document.createElement('p');

        //Add the content type and raw response text to elements
        h2.textContent = contentType;
        rawData.textContent = resText;

        //If the server sent back json
        if(contentType === 'application/json') {
          //Parse the json back into a javascript object, and display the data.
          if(resText){
            const parsedResponse = JSON.parse(resText);
            h1.textContent = `Message: ${parsedResponse.message}`;
            p.textContent = `ID: ${parsedResponse.id}`;
          }
        } 

        //Add the elements to the screen.
        content.innerHTML ="";
        content.appendChild(h1);
      //   content.appendChild(p);
        content.appendChild(h2);
      //   content.appendChild(rawData);       
      });
    };

    let methoder;
    let amount;
   //send the GET request to the server
   function sendFetchRequest(url, restrictions){
      const options = {
         method: methoder.value,
         headers: {
            'restrictions': JSON.stringify(restrictions),
            'type': url,
            'amount': amount.value,
         }
      }
      
      const fetchPromise = fetch(url, options);

      fetchPromise.then((response) => {handleResponse(response)});
   }
   
   let countryRestrictionField;
   let capitalRestrictionField;
   let regionRestrictionField;
   let nationalityRestrictionField;
  function preFetch(url){
    let restriction = {};
    let countryValue = countryRestrictionField.value.trim();
    if(countryValue && (url === '/multi' || url === '/name')) {restriction.name = countryValue;}

    let regionValue = regionRestrictionField.value.trim();
    if(regionValue && (url === '/multi' || url === '/region')) {restriction.region = regionValue;}

    let capitalValue = capitalRestrictionField.value.trim();
    if(capitalValue && (url === '/multi' || url === '/capital')) {restriction.capital = capitalValue;}

    let nationalityValue = nationalityRestrictionField.value.trim();
    if(nationalityValue && (url === '/multi' || url === '/nationality')) {restriction.nationality = countryValue;}
    sendFetchRequest(url,restriction);
  }

   function init(){
      countryRestrictionField = document.querySelector('#countryRestrictionsField');
      const countryForm = document.querySelector('#countryForm');
      const countryButton = document.querySelector('#countrySend');


      capitalRestrictionField = document.querySelector('#capitalRestrictionsField');
      const capitalForm = document.querySelector('#capitalForm');
      const capitalButton = document.querySelector('#capitalSend');


      regionRestrictionField = document.querySelector('#regionRestrictionsField');
      const regionForm = document.querySelector('#regionForm');
      const regionButton = document.querySelector('#regionSend');

      nationalityRestrictionField = document.querySelector('#nationalityRestrictionsField');
      const nationalityForm = document.querySelector('#nationalityForm');
      const nationalityButton = document.querySelector('#nationalitySend');

    };

    window.onload = init;
  </script>
</head>
<body>
  <a href="/">Functional Page</a>
  <br>
  <a href="/docs">Documentation</a>
  <section id="top">
   <h3>Countries Docs Page</h3>
   <hr>
   <!-- something something block quotes and good spacing something something no -->
   <form id ="countryForm" action="/countries" method="get">
      <label for="countryRestrictions">Country Restrictions: </label>
      <h5>The string input for this restriction is to search countries by name</h4>
      <h5>If you use the button to the right of the input bar it will look specifically</h4>
      <h5>for countries with relevant names ignoring all other inputs</h4>
      <h6>Example inputs: <strong>fra</strong>,<strong>france</strong></h6>
      <h6>Both of these will result in just France appearing</h6>
   </form>
   <hr>
   <form id ="capitalForm" action="/capitals" method="get">
      <label for="capitalRestrictions">Capital Restrictions: </label>
      <h5>The string input for this restriction is to search capitals by name</h4>
      <h5>If you use the button to the right of the input bar it will look specifically</h4>
      <h5>for capitals with relevant names ignoring all other inputs</h4>
      <h6>Example input: <strong>akar</strong></h6>
      <h6>Will result in Indonesia's capital, Jakarta and Senegal's capital Dakar being shown</h6>
   </form>
   <hr>
   <form id ="regionForm" action="/regions" method="get">
      <label for="regionRestrictions">Region Restrictions: </label>
      <h5>The string input for this restriction is to search regions by name</h5>
      <h5>If you use the button to the right of the input bar it will look specifically</h5>
      <h5>for capitals with relevant names ignoring all other inputs</h5>
      <h6>Example input: <strong>Europe</strong></h6>
      <h6>Will result in the resulting nations of Europe</h6>
      <h6>Example input: <strong>Amer</strong> to <strong>Americas</strong></h6>
      <h6>Will result in the resulting nations of the Americas</h6>
   </form>
   <hr>
   <form id ="nationalityForm" action="/nationality" method="get">
      <label for="nationalityRestrictions">Nationality Restrictions: </label>
      <h5>The string input for this restriction is to search regions by name</h5>
      <h5>If you use the button to the right of the input bar it will look specifically</h5>
      <h5>for capitals with relevant names ignoring all other inputs</h5>
      <h6>Example input: <strong>germ</strong> to <strong>GERMAN</strong></h6>
      <h6>Will result in the resulting germany</h6>
      <h6>Example input: <strong>Aus</strong> to <strong>austr</strong></h6>
      <h6>Will result in Australia and Austria</h6>
   </form>
   <form>
   <hr>
    <h5>The Send All filters button placed about here will take all the inputs in the restriction bars</h5>
    <h5>and apply them resulting in any number of combinations, that frankly most will be empty</h5>
    <hr>
    <h5>The add button requires all restriction bars to be filled at which point hitting it will add a nation</h5>
    <h5>The edit button only requires the country name to be filled as to adjust any other feature about them</h5>
    <h5>by filling in the other restriction bars</h5>
   </form>

   <form>
   <hr>
    <h5>Method select drop down simply swaps between making GET and HEAD Request for all other buttons</h5>
    <h5>All and Search Params drop down swaps between showing you all the information about a filtered nation</h5>
    <h5>or limiting it to just the search param areas you have filled in</h5>
    <hr>
   </form>

  </section>
  <section id="content">
  </section>
</body>
</html>
